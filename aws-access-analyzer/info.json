{
  "name": "aws-access-analyzer",
  "label": "AWS Access Analyzer",
  "description": "AWS Access Analyzer helps you identify the resources in your organization and accounts, such as Amazon S3 buckets or IAM roles, shared with an external entity, enabling you to identify unintended access to your resources and data, which is a security risk. ",
  "publisher": "Fortinet",
  "cs_approved": true,
  "cs_compatible": true,
  "version": "1.1.0",
  "category": "AWS Service",
  "help_online": "https://docs.fortinet.com/document/fortisoar/1.1.0/aws-access-analyzer/420/aws-access-analyzer-v1-1-0",
  "icon_small_name": "small.png",
  "icon_large_name": "large.png",
  "configuration": {
    "fields": [
      {
        "title": "Configuration Type",
        "required": true,
        "editable": true,
        "visible": true,
        "type": "select",
        "name": "config_type",
        "tooltip": "AWS configuration type",
        "description": "Type of configuration using which you will provide credentials to access AWS Access Analyzer and perform automated actions. You can select between AWS Instance IAM Role or Access Credentials. If you select Aws Instance IAM Role, then enter details in the following field(s): AWS Instance IAM Role Name: IAM Role of your AWS instance to access AWS services. If you selectAccess Credentials, then enter details in the following field(s): AWS Region: AWS region of your account to access the AWS Access Analyzer. AWS Access Key ID: ID of the AWS Access Key to access AWS services. AWS Secret Access Key: Key of the AWS Secret Access to access AWS services.",
        "options": [
          "Access Credentials",
          "AWS Instance IAM Role"
        ],
        "onchange": {
          "AWS Instance IAM Role": [
            {
              "title": "AWS Instance IAM Role Name",
              "required": true,
              "editable": true,
              "visible": true,
              "type": "text",
              "name": "aws_iam_role",
              "tooltip": "IAM Role Name of your AWS Instance where FortiSOAR installed, to access AWS services.",
              "description": "IAM Role Name of your AWS Instance where FortiSOAR installed, to access AWS services."
            }
          ],
          "Access Credentials": [
            {
              "title": "AWS Region",
              "required": true,
              "editable": true,
              "visible": true,
              "type": "text",
              "name": "aws_region",
              "placeholder": "e.g. us-east-2",
              "tooltip": "AWS region of your account to access the AWS Access Analyzer",
              "description": "AWS region of your account to access the AWS Access Analyzer"
            },
            {
              "title": "AWS Access Key ID",
              "required": true,
              "editable": true,
              "visible": true,
              "type": "text",
              "name": "aws_access_key",
              "tooltip": "ID of the AWS Access Key to access AWS services",
              "description": "ID of the AWS Access Key to access AWS services"
            },
            {
              "title": "AWS Secret Access Key",
              "required": true,
              "editable": true,
              "visible": true,
              "type": "password",
              "name": "aws_secret_access_key",
              "tooltip": "Key of the AWS Secret Access to access AWS services",
              "description": "Key of the AWS Secret Access to access AWS services"
            }
          ]
        }
      },
      {
        "title": "Verify SSL",
        "description": "Specifies whether the SSL certificate for the server is to be verified or not. By default, this option is set as True.",
        "required": false,
        "editable": true,
        "visible": true,
        "type": "checkbox",
        "name": "verify_ssl",
        "value": true
      }
    ]
  },
  "operations": [
    {
      "operation": "list_analyzers",
      "title": "List Analyzers",
      "category": "investigation",
      "annotation": "list_analyzers",
      "description": "Retrieves a list of analyzers based on the analyzer type and other input parameters you have specified. ",
      "parameters": [
        {
          "title": "Assume a Role",
          "type": "checkbox",
          "name": "assume_role",
          "required": false,
          "editable": true,
          "visible": true,
          "tooltip": "Enable to assume a role",
          "description": "Select this option to assume a role. This parameter is required, if you have specified 'IAM Role' as the 'Configuration Type'. If you have specified 'Access Credentials' as the 'Configuration Type', then this parameter is optional. If you choose'True', then you must specify the following parameters: AWS Region: AWS region of your account to access the AWS Access Analyzer Role ARN: ARN of the role that you want assume to execute this action on AWS. Session Name: Name of the session that will be created to execute this action on AWS.",
          "value": false,
          "onchange": {
            "true": [
              {
                "title": "AWS Region",
                "required": true,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "aws_region",
                "placeholder": "e.g. us-east-2",
                "tooltip": "Your account's AWS region",
                "description": "AWS region of your account to access the AWS Access Analyzer"
              },
              {
                "title": "Role ARN",
                "type": "text",
                "name": "role_arn",
                "required": true,
                "editable": true,
                "visible": true,
                "placeholder": "arn:aws:iam::{{account_id}}:role/{{role_name}}",
                "tooltip": "ARN of the role that you want assume to execute this action on AWS.",
                "description": "ARN of the role that you want assume to execute this action on AWS."
              },
              {
                "title": "Session Name",
                "type": "text",
                "name": "session_name",
                "required": true,
                "editable": true,
                "visible": true,
                "tooltip": "Name of the session that will be created to execute this action on AWS.",
                "description": "Name of the session that will be created to execute this action on AWS."
              }
            ]
          }
        },
        {
          "title": "Analyzer Type",
          "type": "select",
          "name": "type",
          "required": true,
          "editable": true,
          "visible": true,
          "tooltip": "Select the type of analyzers.",
          "description": "Select the type of analyzers that you want to retrieve using AWS Access Analyzer. You can choose either 'ACCOUNT' or 'ORGANIZATION'.",
          "options": [
            "ACCOUNT",
            "ORGANIZATION"
          ]
        },
        {
          "title": "Max Result Size",
          "type": "integer",
          "name": "size",
          "required": true,
          "editable": true,
          "visible": true,
          "value": 10,
          "placeholder": "10",
          "tooltip": "Specifies the maximum size of analyzer list",
          "description": "Specify the maximum size of the analyzer list that you want to retrieve using AWS Access Analyzer."
        },
        {
          "title": "Next Page Token",
          "type": "text",
          "name": "next_token",
          "required": false,
          "editable": true,
          "visible": true,
          "tooltip": "Specifies the next page token. Not required for the first page. And you can find 'nextToken' value in first page data.",
          "description": "(Optional) The next page token is used for paginating through large result sets. A next page token will be returned whenever the set of available results exceeds the current page size. You can use this parameter to retrieve the next page records using the 'nextToken' value and it is not required for the first page."
        }

      ],
      "enabled": true,
      "output_schema": {
        "analyzers":[
          {
             "arn":"",
             "createdAt":"",
             "lastResourceAnalyzed":"",
             "lastResourceAnalyzedAt":"",
             "name":"",
             "status":"",
             "statusReason":{
                "code":""
             },
             "tags":{
                "string":""
             },
             "type":""
          }
       ],
       "nextToken":""
    }
    },
    {
      "operation": "get_analyzers",
      "title": "Get analyzer details",
      "category": "investigation",
      "annotation": "get_analyzers",
      "description": "Retrieves information about the specified analyzer based on the analyzer name and other input parameters you have specified.",
      "visible": true,
      "parameters": [
        {
          "title": "Assume a Role",
          "type": "checkbox",
          "name": "assume_role",
          "required": false,
          "editable": true,
          "visible": true,
          "tooltip": "Enable to assume a role",
          "description": "Select this option to assume a role. This parameter is required, if you have specified 'IAM Role' as the 'Configuration Type'. If you have specified 'Access Credentials' as the 'Configuration Type', then this parameter is optional. If you choose'True', then you must specify the following parameters: AWS Region: AWS region of your account to access the AWS Access Analyzer Role ARN: ARN of the role that you want assume to execute this action on AWS. Session Name: Name of the session that will be created to execute this action on AWS.",
          "value": false,
          "onchange": {
            "true": [
              {
                "title": "AWS Region",
                "required": true,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "aws_region",
                "placeholder": "e.g. us-east-2",
                "tooltip": "Your account's AWS region",
                "description": "AWS region of your account to access the AWS Access Analyzer"
              },
              {
                "title": "Role ARN",
                "type": "text",
                "name": "role_arn",
                "required": true,
                "editable": true,
                "visible": true,
                "placeholder": "arn:aws:iam::{{account_id}}:role/{{role_name}}",
                "tooltip": "ARN of the role that you want assume to execute this action on AWS.",
                "description": "ARN of the role that you want assume to execute this action on AWS."
              },
              {
                "title": "Session Name",
                "type": "text",
                "name": "session_name",
                "required": true,
                "editable": true,
                "visible": true,
                "tooltip": "Name of the session that will be created to execute this action on AWS.",
                "description": "Name of the session that will be created to execute this action on AWS."
              }
            ]
          }
        },
        {
          "title": "Analyzer Name",
          "type": "text",
          "name": "analyzer_name",
          "required": true,
          "editable": true,
          "visible": true,
          "tooltip": "Specify the name of analyzers.",
          "description": "Specify the name of the analyzer whose details you want to retrieve using AWS Access Analyzer."
        }
      ],
      "enabled": true,
      "output_schema": {
       "arn":"",
       "createdAt":"",
       "lastResourceAnalyzed":"",
       "lastResourceAnalyzedAt":"",
       "name":"",
       "status":"",
       "statusReason":{
          "code":""
       },
       "tags":{
          "string":""
       },
       "type":""
    }
    },
    {
      "operation": "list_analyzed_resources",
      "title": "List of Analyzed Resources",
      "category": "investigation",
      "annotation": "list_analyzed_resources",
      "description": "Retrieves a list of specified resource types that have been analyzed by the specified analyzer based on the analyzer ARN, resource type, and other input parameters you have specified. ",
      "visible": true,
      "parameters": [
        {
          "title": "Assume a Role",
          "type": "checkbox",
          "name": "assume_role",
          "required": false,
          "editable": true,
          "visible": true,
          "tooltip": "Enable to assume a role",
          "description": "Select this option to assume a role. This parameter is required, if you have specified 'IAM Role' as the 'Configuration Type'. If you have specified 'Access Credentials' as the 'Configuration Type', then this parameter is optional. If you choose'True', then you must specify the following parameters: AWS Region: AWS region of your account to access the AWS Access Analyzer Role ARN: ARN of the role that you want assume to execute this action on AWS. Session Name: Name of the session that will be created to execute this action on AWS.",
          "value": false,
          "onchange": {
            "true": [
              {
                "title": "AWS Region",
                "required": true,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "aws_region",
                "placeholder": "e.g. us-east-2",
                "tooltip": "Your account's AWS region",
                "description": "AWS region of your account to access the AWS Access Analyzer"
              },
              {
                "title": "Role ARN",
                "type": "text",
                "name": "role_arn",
                "required": true,
                "editable": true,
                "visible": true,
                "placeholder": "arn:aws:iam::{{account_id}}:role/{{role_name}}",
                "tooltip": "ARN of the role that you want assume to execute this action on AWS.",
                "description": "ARN of the role that you want assume to execute this action on AWS."
              },
              {
                "title": "Session Name",
                "type": "text",
                "name": "session_name",
                "required": true,
                "editable": true,
                "visible": true,
                "tooltip": "Name of the session that will be created to execute this action on AWS.",
                "description": "Name of the session that will be created to execute this action on AWS."
              }
            ]
          }
        },
        {
          "title": "Analyzer ARN",
          "type": "text",
          "name": "analyzer_arn",
          "required": true,
          "editable": true,
          "visible": true,
          "tooltip": "Specify the arn of analyzers.",
          "description": "Specify the ARN of the analyzer whose analyzed resources you want to retrieve using AWS Access Analyzer."
        },
        {
          "title": "Resource Type",
          "type": "select",
          "name": "resource_type",
          "required": false,
          "editable": true,
          "visible": true,
          "tooltip": "Select the type of resources.",
          "description": "Select the type of resources you want to retrieve using AWS Access Analyzer. You can choose from resource types such as AWS::IAM::Role, AWS::S3::Bucket, AWS::KMS::Key, etc. ",
          "options": [
            "AWS::S3::Bucket",
            "AWS::IAM::Role",
            "AWS::SQS::Queue",
            "AWS::Lambda::Function",
            "AWS::Lambda::LayerVersion",
            "AWS::KMS::Key",
            "AWS::SecretsManager::Secret"
          ]
        },
        {
          "title": "Max Result Size",
          "type": "integer",
          "name": "size",
          "required": false,
          "editable": true,
          "visible": true,
          "value": 10,
          "placeholder": 10,
          "tooltip": "Specifies the maximum size of analyzed resource list",
          "description": "Specify the maximum size of the analyzed resource list that you want to retrieve using AWS Access Analyzer."
        },
        {
          "title": "Next Page Token",
          "type": "text",
          "name": "next_token",
          "required": false,
          "editable": true,
          "visible": true,
          "tooltip": "Specifies the next page token. Not required for the first page. And you can find 'nextToken' value in first page data.",
          "description": "(Optional) The next page token is used for paginating through large result sets. A next page token will be returned whenever the set of available results exceeds the current page size. You can use this parameter to retrieve the next page records using the 'nextToken' value and it is not required for the first page."
        }
      ],
      "enabled": true,
      "output_schema": {
         "analyzedResources":[
            {
               "resourceArn":"",
               "resourceOwnerAccount":"",
               "resourceType":""
            }
         ],
         "nextToken":""
      }
    },
    {
      "operation": "get_analyzed_resources",
      "title": "Details of an Analyzed Resources",
      "category": "investigation",
      "annotation": "get_analyzed_resources",
      "description": "Retrieves information about a resource that was analyzed by the specified analyzer based on the analyzer ARN and resource ARN you have specified. ",
      "visible": true,
      "parameters": [
        {
          "title": "Assume a Role",
          "type": "checkbox",
          "name": "assume_role",
          "required": false,
          "editable": true,
          "visible": true,
          "tooltip": "Enable to assume a role",
          "description": "Select this option to assume a role. This parameter is required, if you have specified 'IAM Role' as the 'Configuration Type'. If you have specified 'Access Credentials' as the 'Configuration Type', then this parameter is optional. If you choose'True', then you must specify the following parameters: AWS Region: AWS region of your account to access the AWS Access Analyzer Role ARN: ARN of the role that you want assume to execute this action on AWS. Session Name: Name of the session that will be created to execute this action on AWS.",
          "value": false,
          "onchange": {
            "true": [
              {
                "title": "AWS Region",
                "required": true,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "aws_region",
                "placeholder": "e.g. us-east-2",
                "tooltip": "Your account's AWS region",
                "description": "AWS region of your account to access the AWS Access Analyzer"
              },
              {
                "title": "Role ARN",
                "type": "text",
                "name": "role_arn",
                "required": true,
                "editable": true,
                "visible": true,
                "placeholder": "arn:aws:iam::{{account_id}}:role/{{role_name}}",
                "tooltip": "ARN of the role that you want assume to execute this action on AWS.",
                "description": "ARN of the role that you want assume to execute this action on AWS."
              },
              {
                "title": "Session Name",
                "type": "text",
                "name": "session_name",
                "required": true,
                "editable": true,
                "visible": true,
                "tooltip": "Name of the session that will be created to execute this action on AWS.",
                "description": "Name of the session that will be created to execute this action on AWS."
              }
            ]
          }
        },
        {
          "title": "Analyzer ARN",
          "type": "text",
          "name": "analyzer_arn",
          "required": true,
          "editable": true,
          "visible": true,
          "tooltip": "Specify the arn of analyzers.",
          "description": "Specify the ARN of the analyzer whose analyzed resource details you want to retrieve using AWS Access Analyzer."
        },
        {
          "title": "Resource ARN",
          "type": "text",
          "name": "resource_arn",
          "required": true,
          "editable": true,
          "visible": true,
          "tooltip": "Specify the arn of resources.",
          "description": "Specify the ARN of resources that were analyzed using the specified analyzer."
        }
      ],
      "enabled": true,
      "output_schema": {
       "resource":{
          "actions":[
             ""
          ],
          "analyzedAt":"",
          "createdAt":"",
          "error":"",
          "isPublic":"",
          "resourceArn":"",
          "resourceOwnerAccount":"",
          "resourceType":"",
          "sharedVia":[
             ""
          ],
          "status":"",
          "updatedAt":""
       }
    }
    },
    {
      "operation": "list_findings",
      "title": "List of Findings",
      "category": "investigation",
      "annotation": "list_findings",
      "description": "Retrieves a list of findings generated by the specified analyzer based on the analyzer ARN and other input parameters you have specified. ",
      "visible": true,
      "parameters": [
        {
          "title": "Assume a Role",
          "type": "checkbox",
          "name": "assume_role",
          "required": false,
          "editable": true,
          "visible": true,
          "tooltip": "Enable to assume a role",
          "description": "Select this option to assume a role. This parameter is required, if you have specified 'IAM Role' as the 'Configuration Type'. If you have specified 'Access Credentials' as the 'Configuration Type', then this parameter is optional. If you choose'True', then you must specify the following parameters: AWS Region: AWS region of your account to access the AWS Access Analyzer Role ARN: ARN of the role that you want assume to execute this action on AWS. Session Name: Name of the session that will be created to execute this action on AWS.",
          "value": false,
          "onchange": {
            "true": [
              {
                "title": "AWS Region",
                "required": true,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "aws_region",
                "placeholder": "e.g. us-east-2",
                "tooltip": "Your account's AWS region",
                "description": "AWS region of your account to access the AWS Access Analyzer"
              },
              {
                "title": "Role ARN",
                "type": "text",
                "name": "role_arn",
                "required": true,
                "editable": true,
                "visible": true,
                "placeholder": "arn:aws:iam::{{account_id}}:role/{{role_name}}",
                "tooltip": "ARN of the role that you want assume to execute this action on AWS.",
                "description": "ARN of the role that you want assume to execute this action on AWS."
              },
              {
                "title": "Session Name",
                "type": "text",
                "name": "session_name",
                "required": true,
                "editable": true,
                "visible": true,
                "tooltip": "Name of the session that will be created to execute this action on AWS.",
                "description": "Name of the session that will be created to execute this action on AWS."
              }
            ]
          }
        },
        {
          "title": "Analyzer ARN",
          "type": "text",
          "name": "analyzer_arn",
          "required": true,
          "editable": true,
          "visible": true,
          "tooltip": "Specify the arn of analyzers.",
          "description": "Specify the ARN of the analyzer whose findings you want to retrieve using AWS Access Analyzer."
        },
        {
          "title": "Max Result Size",
          "type": "integer",
          "name": "size",
          "required": false,
          "editable": true,
          "visible": true,
          "value": 10,
          "placeholder": 10,
          "tooltip": "Specifies the maximum size of finding list",
          "description": "Specify the maximum size of the findings list that you want to retrieve using AWS Access Analyzer."
        },
        {
          "title": "Filter Query",
          "type": "json",
          "name": "filter",
          "required": false,
          "editable": true,
          "visible": true,
          "tooltip": "Specifies the filter query.",
          "description": "(Optional) Specify a query using which you want to filter the finding list retrieved using AWS Access Analyzer. "
        },
        {
          "title": "Sort Parameter",
          "type": "json",
          "name": "sort",
          "required": false,
          "editable": true,
          "visible": true,
          "tooltip": "Specifies the sort attributes",
          "description": "(Optional) Specify the attributes using which you want to sort the finding list retrieved using AWS Access Analyzer. "
        },
        {
          "title": "Next Page Token",
          "type": "text",
          "name": "next_token",
          "required": false,
          "editable": true,
          "visible": true,
          "tooltip": "Specifies the next page token. Not required for the first page. And you can find 'nextToken' value in first page data.",
          "description": "(Optional) The next page token is used for paginating through large result sets. A next page token will be returned whenever the set of available results exceeds the current page size. You can use this parameter to retrieve the next page records using the 'nextToken' value and it is not required for the first page.  "
        }

      ],
      "enabled": true,
      "output_schema": {
         "findings":[
            {
               "action":[
                  ""
               ],
               "analyzedAt":"",
               "condition":{
                  "string":""
               },
               "createdAt":"",
               "error":"",
               "id":"",
               "isPublic":"",
               "principal":{
                  "string":""
               },
               "resource":"",
               "resourceOwnerAccount":"",
               "resourceType":"",
               "sources":[
                  {
                     "detail":{
                        "accessPointArn":""
                     },
                     "type":""
                  }
               ],
               "status":"",
               "updatedAt":""
            }
         ],
         "nextToken":""
      }
    },
    {
      "operation": "get_findings",
      "title": "Get Finding Details",
      "category": "investigation",
      "annotation": "get_findings",
      "description": "Retrieves information about the specified finding generated by the specified analyzer based on the analyzer ARN and finding ID you have specified.",
      "visible": true,
      "parameters": [
        {
          "title": "Assume a Role",
          "type": "checkbox",
          "name": "assume_role",
          "required": false,
          "editable": true,
          "visible": true,
          "tooltip": "Enable to assume a role",
          "description": "Select this option to assume a role. This parameter is required, if you have specified 'IAM Role' as the 'Configuration Type'. If you have specified 'Access Credentials' as the 'Configuration Type', then this parameter is optional. If you choose'True', then you must specify the following parameters: AWS Region: AWS region of your account to access the AWS Access Analyzer Role ARN: ARN of the role that you want assume to execute this action on AWS. Session Name: Name of the session that will be created to execute this action on AWS.",
          "value": false,
          "onchange": {
            "true": [
              {
                "title": "AWS Region",
                "required": true,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "aws_region",
                "placeholder": "e.g. us-east-2",
                "tooltip": "Your account's AWS region",
                "description": "AWS region of your account to access the AWS Access Analyzer"
              },
              {
                "title": "Role ARN",
                "type": "text",
                "name": "role_arn",
                "required": true,
                "editable": true,
                "visible": true,
                "placeholder": "arn:aws:iam::{{account_id}}:role/{{role_name}}",
                "tooltip": "ARN of the role that you want assume to execute this action on AWS.",
                "description": "ARN of the role that you want assume to execute this action on AWS."
              },
              {
                "title": "Session Name",
                "type": "text",
                "name": "session_name",
                "required": true,
                "editable": true,
                "visible": true,
                "tooltip": "Name of the session that will be created to execute this action on AWS.",
                "description": "Name of the session that will be created to execute this action on AWS."
              }
            ]
          }
        },
        {
          "title": "Analyzer ARN",
          "type": "text",
          "name": "analyzer_arn",
          "required": true,
          "editable": true,
          "visible": true,
          "tooltip": "Specify the arn of analyzers.",
          "description": "Specify the ARN of the analyzer whose finding details you want to retrieve using AWS Access Analyzer."
        },
        {
          "title": "ID",
          "type": "text",
          "name": "id",
          "required": true,
          "editable": true,
          "visible": true,
          "tooltip": "Specifies the id of findings",
          "description": "Specify the ID of findings whose details you want to retrieve using AWS Access Analyzer. "
        }
      ],
      "enabled": true,
      "output_schema": {
       "finding":{
          "action":[
             ""
          ],
          "analyzedAt":"",
          "condition":{
             "string":""
          },
          "createdAt":"",
          "error":"",
          "id":"",
          "isPublic":"",
          "principal":{
             "string":""
          },
          "resource":"",
          "resourceOwnerAccount":"",
          "resourceType":"",
          "sources":[
             {
                "detail":{
                   "accessPointArn":""
                },
                "type":""
             }
          ],
          "status":"",
          "updatedAt":""
       }
    }
    },
    {
      "operation": "start_resource_scan",
      "title": "Start Resource Scan",
      "category": "investigation",
      "annotation": "start_resource_scan",
      "description": "Immediately starts a scan of the policies applied to the specified resource based on the analyzer ARN and resource ARN you have specified. ",
      "visible": true,
      "parameters": [
        {
          "title": "Assume a Role",
          "type": "checkbox",
          "name": "assume_role",
          "required": false,
          "editable": true,
          "visible": true,
          "tooltip": "Enable to assume a role",
          "description": "Select this option to assume a role. This parameter is required, if you have specified 'IAM Role' as the 'Configuration Type'. If you have specified 'Access Credentials' as the 'Configuration Type', then this parameter is optional. If you choose'True', then you must specify the following parameters: AWS Region: AWS region of your account to access the AWS Access Analyzer Role ARN: ARN of the role that you want assume to execute this action on AWS. Session Name: Name of the session that will be created to execute this action on AWS.",
          "value": false,
          "onchange": {
            "true": [
              {
                "title": "AWS Region",
                "required": true,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "aws_region",
                "placeholder": "e.g. us-east-2",
                "tooltip": "Your account's AWS region",
                "description": "AWS region of your account to access the AWS Access Analyzer"
              },
              {
                "title": "Role ARN",
                "type": "text",
                "name": "role_arn",
                "required": true,
                "editable": true,
                "visible": true,
                "placeholder": "arn:aws:iam::{{account_id}}:role/{{role_name}}",
                "tooltip": "ARN of the role that you want assume to execute this action on AWS.",
                "description": "ARN of the role that you want assume to execute this action on AWS."
              },
              {
                "title": "Session Name",
                "type": "text",
                "name": "session_name",
                "required": true,
                "editable": true,
                "visible": true,
                "tooltip": "Name of the session that will be created to execute this action on AWS.",
                "description": "Name of the session that will be created to execute this action on AWS."
              }
            ]
          }
        },
        {
          "title": "Analyzer ARN",
          "type": "text",
          "name": "analyzer_arn",
          "required": true,
          "editable": true,
          "visible": true,
          "tooltip": "Specify the arn of analyzers.",
          "description": "Specify the ARN of the analyzer using which you want to scan the policies on the specified resource."
        },
        {
          "title": "Resource ARN",
          "type": "text",
          "name": "resource_arn",
          "required": true,
          "editable": true,
          "visible": true,
          "tooltip": "Specify the arn of resources.",
          "description": "Specify the ARN of resources whose associated policies you want to scan using the specified analyzer."
        }
      ],
      "enabled": true,
      "output_schema": {}
    },
    {
      "operation": "update_findings",
      "title": "Update Findings Status",
      "category": "investigation",
      "annotation": "update_findings",
      "description": "Updates the status of the specified findings of a specified analyzer based on the analyzer ARN, resource ARN, findings IDs, and other input parameters you have specified. ",
      "visible": true,
      "parameters": [
        {
          "title": "Assume a Role",
          "type": "checkbox",
          "name": "assume_role",
          "required": false,
          "editable": true,
          "visible": true,
          "tooltip": "Enable to assume a role",
          "description": "Select this option to assume a role. This parameter is required, if you have specified 'IAM Role' as the 'Configuration Type'. If you have specified 'Access Credentials' as the 'Configuration Type', then this parameter is optional. If you choose'True', then you must specify the following parameters: AWS Region: AWS region of your account to access the AWS Access Analyzer Role ARN: ARN of the role that you want assume to execute this action on AWS. Session Name: Name of the session that will be created to execute this action on AWS.",
          "value": false,
          "onchange": {
            "true": [
              {
                "title": "AWS Region",
                "required": true,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "aws_region",
                "placeholder": "e.g. us-east-2",
                "tooltip": "Your account's AWS region",
                "description": "AWS region of your account to access the AWS Access Analyzer"
              },
              {
                "title": "Role ARN",
                "type": "text",
                "name": "role_arn",
                "required": true,
                "editable": true,
                "visible": true,
                "placeholder": "arn:aws:iam::{{account_id}}:role/{{role_name}}",
                "tooltip": "ARN of the role that you want assume to execute this action on AWS.",
                "description": "ARN of the role that you want assume to execute this action on AWS."
              },
              {
                "title": "Session Name",
                "type": "text",
                "name": "session_name",
                "required": true,
                "editable": true,
                "visible": true,
                "tooltip": "Name of the session that will be created to execute this action on AWS.",
                "description": "Name of the session that will be created to execute this action on AWS."
              }
            ]
          }
        },
        {
          "title": "Analyzer ARN",
          "type": "text",
          "name": "analyzer_arn",
          "required": true,
          "editable": true,
          "visible": true,
          "tooltip": "Specify the arn of analyzers.",
          "description": "Specify the ARN of the analyzer whose findings' status you want to update using AWS Access Analyzer."
        },
        {
          "title": "Update By",
          "type": "select",
          "name": "update_by",
          "required": true,
          "editable": true,
          "visible": true,
          "description": "Select options from which you want to update the status of findings.",
          "value": "Resource ARN",
          "options": ["Resource ARN", "Findings IDs"],
          "onchange": {
            "Resource ARN": [
              {
                "title": "Resource ARN",
                "type": "text",
                "name": "resource_arn",
                "required": true,
                "editable": true,
                "visible": true,
                "tooltip": "Specify the arn of resources.",
                "description": "Specify the ARN of resources whose findings' status you want to update using the specified analyzer."
              }
            ],
            "Findings IDs": [
              {
                "title": "ID List",
                "type": "json",
                "name": "ids",
                "required": true,
                "editable": true,
                "visible": true,
                "value": [],
                "placeholder": ["id1", "id2"],
                "tooltip": "Comma separated list of ID's.",
                "description": "Specify a comma-separated list of findings' IDs whose status you want to update using AWS Access Analyzer. "
              }
            ]
          }
        },
        {
          "title": "Status",
          "type": "select",
          "name": "status",
          "required": true,
          "editable": true,
          "visible": true,
          "value": "ACTIVE",
          "tooltip": "Select the status of the specified findings as either 'ACTIVE' or 'ARCHIVED'. ",
          "description": "Select the status of the specified findings as either 'ACTIVE' or 'ARCHIVED'. ",
          "options": [
            "ACTIVE",
            "ARCHIVED"
          ]
        },
        {
          "title": "Client Token",
          "type": "text",
          "name": "client_token",
          "required": false,
          "editable": true,
          "visible": true,
          "tooltip": "Specifies the client token",
          "description": "Specify the client token to update the status of the specified findings. "
        }
      ],
      "enabled": true,
      "output_schema": {}
    }
  ]

}